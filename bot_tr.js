!function(a){let f=a.room=HBInit({roomName:"👽 Haxball Odası",public:!0,maxPlayers:12,noPlayer:!0});f.setTeamColors(1,60,16777215,[11730944,7208960,3866624]),f.setTeamColors(2,60,16777215,[1079446,809328,606546]),f.setTeamsLock(!0),f.setScoreLimit(3),f.setTimeLimit(5),f.setDefaultStadium("Easy"),f.startGame();let u=a.Bot={config:{adminPass:"aDm123",mapsUrl:""},pa:[],po:{},data:{mode:4,popLimit:0,msg:"",recent:[],nameBL:[],connBL:[],maps:[]}},g=a.Lib={t:null,balance:()=>{var o=u.data.mode;if(-1!==o){let a=Math,e=[[],[],[],[],[]],t,n=u.pa,l,i,s,r;for(t=n.length-1;0<=t;t--)l=n[t],i=l.pref,i.afk||(0===i.team?e[l.team].push(l.id):(e[a.abs(i.team)+2].push(l.id),i.team<0&&(i.team=0)));for(n=e[0],t=n.length-1;0<t;t--)i=a.floor(a.random()*(t+1)),l=n[t],n[t]=n[i],n[i]=l;for(t=n.length-1;0<=t&&(s=e[1].length+e[3].length,r=e[2].length+e[4].length,!(0<o&&s>=o&&r>=o));t--)i=s-r,l=0===i?1+a.floor(2*a.random()):0<i?2:1,e[l].push(n[t]),n.splice(t,1);if(0===o){if(i=e[1].length+e[3].length-e[2].length-e[4].length,i<-1||1<i)for(r=i<0?2:1,n=e[r],i=a.floor(a.abs(i)/2),t=n.length-1;0<=t&&(l=n[t],e[3-r].push(l),n.splice(t,1),i--,0!==i);t--);}else for(t=1;t<3;t++)if(n=e[t],l=n.length+e[t+2].length,l>o)for(l-=o,i=n.length-1;0<=i&&(e[0].push(n[i]),n.splice(i,1),l--,0!==l);i--);for(t=0;t<5;t++)for(l=e[t],i=l.length-1;0<=i;i--)f.setPlayerTeam(l[i],t<3?t:t-2)}},stats:{ks:[],data:[0,0,10,1,700,700*.7,0,0],w:[[0,20,40,30,0,20,10,5,20,-5,-5],[0,20,10,30,0,20,30,40,10,-10,-1]],calc:(a=!1)=>{let e=g.stats,t=e.ks,n=e.data,l=n[1],i,s,r,o,m,d,c=u.po;for(n[0]=1,o=0;o<l-2;o++)i=t[o],s=t[o+1],r=t[o+2],m=c[s[0]],m&&(d=m.log.newStats,s[1]!==i[1]?(s[2]*Math.sign(1.5-s[1])>=n[5]&&d[7]++,s[1]===r[1]&&(d[6]++,s[0]!==r[0]&&(d[4]++,d[5]++))):s[0]!==r[0]&&(d[4]++,s[1]===r[1]&&d[5]++));if(a)for(n[1]=2,i=0;i<2;i++)for(s=0;s<4;s++)t[i][s]=t[l-2+i][s];else n[1]=0;n[0]=0},f:{reset:()=>{g.stats.calc()},init:()=>{let e=f,t=g.stats,n=t.data;if(n[3]){let a=t.f;e.onPlayerBallKick=a.onKick,e.onTeamGoal=a.onGoal,e.onPositionsReset=a.reset,n[0]=0,n[1]=0;var l=n[2];for(t=t.ks,e=0;e<l;e++)for(t[e]=[],t[e].length=4,a=0;a<4;a++)t[e][a]=0}else e.onPlayerBallKick=null,e.onTeamGoal=null,e.onPositionsReset=null},calcScores:a=>{let e=g.stats.w,t=a.log,n=t.aggStats,l=t.aggScores,i=n[0],s,r=e[0].length,o,m;if(!(i<=0))for(o=0;o<2;o++){for(l[o]=0,m=e[o],s=r-1;0<s;s--)l[o]+=n[s]/i*m[s]*10;l[o]=Math.ceil(l[o])}},onKick:t=>{let n=g.stats,l=n.data;if(!l[0]){let a=++l[1],e=n.ks[a-1];e[0]=t.id,e[1]=t.team,e[2]=Date.now(),e[3]=t.position.x,a>=l[2]&&n.calc(!0)}},onGoal:a=>{let e=u.po,t=g,n=t.stats,l=n.ks,i=n.data,s=i[1]-1,r,o=!1,m,d,c="⚽ Gol!";return i[0]=1,0===i[4]&&(i[4]=Math.abs(Math.round(f.getBallPosition().x)),i[5]=.7*i[4]),s<0?t.say(c):(m=l[s],0<s&&(d=l[s-1]),m[1]===a?(o=!0,r=e[m[0]]):d&&d[1]===a&&m[2]-d[2]<1e3&&(o=!0,r=e[d[0]],m=d,d=1<s?l[s-2]:null),o||(r=e[m[0]]),r?(c+=" "+r.name+" (",o?(c+="mesafe: "+Math.ceil(Math.abs(i[4]*Math.sign(1.5-a)-m[3])/14)+"m",r.log.newStats[2]++,r=null,d&&d[1]===a&&d[0]!==m[0]&&(r=e[d[0]]),r&&(c+=", asist: "+r.name,r.log.newStats[3]++)):(r.log.newStats[10]++,c+="kendi kalesine"),c+=")",g.say(c)):t.say(c))},victory:l=>{let a=f,e=u.data.mode;if(a.stopGame(),-1===e)return a.startGame();let i=u.pa,s,r,o,t=g,m=t.stats,n=m.data,d=l.red>l.blue?1:2;if(m.calc(),n[5+d]++,n[8-d]=0,t.say("🏆 "+(1==d?"Kırmızı":"Mavi")+" takım kazandı. Tebrikler! Kırmızı "+n[6]+":"+n[7]+" Mavi"),(2<n[6]||2<n[7])&&(e=-2,n[6]=0,n[7]=0,t.say("Üç maçlık galibiyet serisi, takımlar karılıyor..")),n[3]){let a,e,t,n=m.f.calcScores;for(s=i.length-1;0<=s;s--){for(r=i[s],e=r.log,o=e.newStats,t=e.aggStats,r.team===d?(o[0]++,o[1]++):r.team===3-d&&o[0]++,1===r.team?(o[8]=l.red,o[9]=l.blue):(o[8]=l.blue,o[9]=l.red),a=0;a<11;a++)t[a]+=o[a],o[a]=0;n(r)}}for(s=i.length-1;0<=s;s--)r=i[s],o=r.pref,o.afk||(-2===e?(o.team=r.team===d?-1-Math.round(Math.random()):o.team,r.team=0,a.setPlayerTeam(r.id,0)):0===e||r.team===3-d?(r.team=0,a.setPlayerTeam(r.id,0)):0===r.team&&(o.team=d-3));t.balance(),a.startGame()}}},fetchMaps:()=>{if(!(u.config.mapsUrl.length<1)){let e=u.data;fetch(u.config.mapsUrl).then(function(a){return a.ok?a.json():Promise.reject({status:a.status,statusText:a.statusText})}).then(function(a){e.maps=a}).catch(a=>{console.log(a)})}},setPW:(a,e=!1)=>{a=!a||a.length<1?null:-1===a?Math.round(1e9*Math.random()).toString(16):a;f.setPassword(a),e&&g.msgAdmins("şifre"+(null===a?" temizlendi":": "+a))},nameToPlayer:(a=null)=>{if(null===a||a.length<1)return null;if("#"===a[0])return u.po[parseInt(a.substring(1))];a=a.toLowerCase();let e=u.pa,t,n,l;for(t=e.length-1;0<=t;t--)if(n=e[t],l=n.name.toLowerCase(),l===a)return n;for(t=e.length-1;0<=t;t--)if(n=e[t],l=n.name.toLowerCase(),l.includes(a))return n;return null},mix:a=>{let e,t,n=u.pa;for(e=n.length-1;0<=e;e--)t=n[e],f.setPlayerTeam(t.id,0),t.team=0;g.balance(),a&&a()},mute:(a,e,t=null,n=!0)=>{a.log.mu=Date.now()+6e4*e,n&&g.say("🔕 "+a.name+" "+(0<e?e+" dakika susturuldu"+(t?" ("+t+")":""):"artık konuşabilir"))},say:(a,e)=>{f.sendAnnouncement(a,e,e?10151397:8513796)},msgAdmins:(a,e=1)=>{let t,n,l=u.pa;for(t=l.length-1;0<=t;t--)n=l[t],n.admin>=e&&f.sendAnnouncement(a,n.id,16768768)},ch:{help:{f:(t,n)=>{let l=g,i=l.ch,s;if(n.length)n[0]in i&&(s=i[n[0]],"h"in s&&s.h&&s.a<=t.admin&&l.say(s.h,t.id));else{let a=[],e=Object.keys(i);for(n=0;n<e.length;n++)s=i[e[n]],s.a<=t.admin&&a.push(e[n]);a.length&&l.say("komutlar: "+a.join(", "),t.id),l.say("detaylı bilgi: .help [cmd] veya https://github.com/uzayyli/Haxball-Headless-Bot",t.id)}},h:null,a:0,c:10},stats:{f:(l,i)=>{let s=g,r=i.length<1?l:s.nameToPlayer(i[0]);if(r){if(2===i.length&&"reset"===i[1]&&(0<l.admin||l.id===r.id))return r.log.stats=[0,0,0,0],i=r.name+" istatistikleri sıfırlandı ("+l.name+")",s.say(i,r.id),s.msgAdmins(i);let a=r.log,e=a.aggScores,t=a.aggStats,n=s.say;if(t[0]<1)return n("Kayıtlı maç yok",l.id);n(r.name+": Ofansif puan: "+Math.ceil(e[0])+", Defansif puan: "+Math.ceil(e[1]),l.id),n(t[0]+" maçta "+t[2]+" gol, "+t[3]+" asist, "+t[7]+" kurtarış, "+t[6]+" top çalma, %"+Math.ceil(t[5]/t[4]*100)+" pas isabeti, %"+Math.ceil(t[1]/t[0]*100)+" kazanma oranı",l.id),n("Maç başına "+(t[2]/t[0]).toFixed(1)+" gol, "+(t[3]/t[0]).toFixed(1)+" asist, "+(t[7]/t[0]).toFixed(1)+" kurtarış, "+(t[6]/t[0]).toFixed(1)+" top çalma, "+(t[5]/t[0]).toFixed(1)+" isabetli pas, "+(t[8]/t[0]).toFixed(1)+" takım golü, "+(t[9]/t[0]).toFixed(1)+" yenen gol",l.id),t[4]<5&&n("Sıralamalara girmek için en az beş maç gerekiyor",l.id)}},h:"stats ([player]) (reset)",a:0,c:30},top:{f:(a,e)=>{let t=g,n=!1,l,i="aggStats",s=-1,r;if(e.length||(n=!0),!n)switch(l=e[0].toLowerCase().substring(0,4),l){case"atta":i="aggScores",r="En iyi hücum oyuncuları (ofansif puan)",s=0;break;case"defe":i="aggScores",r="En iyi savunma oyuncuları (defansif puan)",s=1;break;case"goal":r="Gol kralları (maç başına gol)",s=2;break;case"assi":r="Asist kralları (maç başına asist)",s=3;break;case"save":r="En iyi kaleciler (maç başına kurtarış)",s=7;break;default:n=!0}if(n)return a.log.cc=0,t.say("doğru kullanım: "+t.ch.top.h,a.id);for(n=u.pa.map(a=>{var e=a.log,t=e[i],n="aggStats"===i?t[0]:1;return{name:a.name,v:e.aggStats[0]<5||0===n?0:t[s]/n}}).sort((a,e)=>e.v-a.v),i=Math.min(3,n.length),t.say(r+":",a.id),r="",s=0;s<i;s++)r+=n[s].name+" ("+n[s].v.toFixed(2)+")",s<i-1&&(r+=", ");t.say(r,a.id)},h:"top [goals/assists/saves/attackers/defenders]",a:0,c:20},afk:{f:(t,n)=>{if(!(n.length&&t.admin<1)){let a=g,e=0===n.length?t:a.nameToPlayer(n[0]);e&&((t=e.pref).afk=!t.afk,a.say(e.name+" AFK"+(t.afk?"":" değil")+"."),t.team=0,t.afk&&f.setPlayerTeam(e.id,0),a.balance())}},h:"afk ([player])",a:0,c:30},admin:{f:(a,e)=>{let t=a,n=2,l=null;if(e[0]!==u.config.adminPass){if(a.admin<1)return;1<a.admin&&(t=g.nameToPlayer(e[0]),n=parseInt(e[1]),(isNaN(n)||n<0)&&(n=0),l=2<e.length)}null===l&&(l=1<e.length),t.admin=n,g.msgAdmins(t.name+" "+(l?"gizli ":"")+"admin "+(0<n?"L"+n+" ":"değil ")+"("+a.name+")"),f.setPlayerAdmin(t.id,0<n&&!l)},h:"admin [password] (hidden) or admin [player] [level] (hidden)",a:0,c:20},mute:{f:(a,e)=>{let t=e[0].toLowerCase(),n=Math.min(parseFloat(e[1]),10),l,i=g.mute;if((isNaN(n)||n<0)&&(n=0),"all"===t){let a,e=u.pa;for(a=e.length-1;0<=a;a--)l=e[a],l.a||i(l,n,null,!1);g.say("🔕 herkes "+(0<n?n+" dakika susturuldu":"konuşabilir"))}else l=g.nameToPlayer(t),l.a||i(l,n,"admin")},h:"mute [player]/all [minutes]",a:2},avatar:{f:(a,e)=>{let t=e[0],n=e[1][0],l,i,s;if("all"===t)i=u.pa;else{if(i=g.nameToPlayer(t),!i)return;i=[i]}for(t=i.length,l="c"===n?null:"d"===n?"🎃":e[1],s=t-1;0<=s;s--)f.setPlayerAvatar(i[s].id,l);1===t&&(i[0].log.av=l)},h:"avatar [player]/all clear/default/[av]",a:2},game:{f:(a,e)=>{let t=g.mix,n=a.name;switch(e[0]){case"mix":t(),n+=" takımları kardı";break;case"remix":f.stopGame(),t(f.startGame),n+=" takımları kardı";break;case"restart":f.stopGame(),f.startGame(),n+=" oyunu yeniden başlattı";break;default:n=null}n&&g.say(n)},h:"game mix/remix/restart ([value])",a:1},mode:{f:(a,e)=>{let t=e[0][0].toLowerCase();t="m"===t?-1:"x"===t?0:parseInt(e[0]),t=isNaN(t)?0:t<0?-1:t,u.data.mode=t,g.balance(),g.msgAdmins("Oyun modu: "+(-1===t?"manuel":0===t?"herkes oyunda":t+"v"+t)+" ("+a.name+")")},h:"mode manual/ffa/1v1/2v2/..",a:2},say:{f:(a,e)=>{g.say(e.join(" "))},h:null,a:1},v:{f:(a,e)=>{g.say("v5.4.4c")},h:null,a:0,c:20},m:{f:(a,e)=>{let t=u.data;e.length&&(t.msg=e.join(" ")),g.say(t.msg)},h:"m ([msg])",a:1},pm:{f:(a,e)=>{var t=e.slice(1).join(" "),e=g.nameToPlayer(e[0]);g.say("(PM) "+a.name+": "+t,e.id),g.say("(PM to "+e.name+"): "+t,a.id)},h:"pm [player] [msg]",a:2},blacklist:{f:(a,e)=>{let t=e[0],n=e[1],l=u.data,i;switch(t){case"recent":for(g.say("recent players (oldest first):",a.id),l=l.recent,n=0;n<l.length;n++)t=l[n],g.say('"'+t.name+'": '+t.conn,a.id);i=null;break;case"ip":t=l.connBL,-1===t.indexOf(n)&&t.push(n);var s=l.recent.find(a=>a.conn===n);i=(s?s.name:n)+" ip-blacklistlendi";break;case"name":l=l.nameBL,-1===l.indexOf(n)&&l.push(n),i=n+" name-blacklistlendi";break;case"clear":l.nameBL=[],l.connBL=[],i="blacklistler temizlendi";break;case"get":g.msgAdmins("Names: "+l.nameBL.join(", ")),i="IPs:"+l.connBL.join(", ");break;default:g.say("pls "+g.ch.blacklist.h,a.id),i=null}i&&g.msgAdmins(i)},h:"blacklist clear/get/recent/ip/name ([conn/ExactName])",a:2},team:{f:(a,e)=>{let t=e[0],n=e[1][0],l,i,s,r=g,o=!1;if("-"===n&&(o=!0,e[1]=e[1].substring(1),n=e[1][0]),i="r"===n?1:"b"===n?2:"n"===n?0:parseInt(e[1]),(isNaN(i)||i<0||2<i)&&(i=0),"all"===t)n=u.pa,s="Herkes";else{if(n=r.nameToPlayer(t),!n)return;s=n.name,n=[n]}if(r.say(s+" "+(0===i?"takım tercihini sildi":(1===i?"kırmızı":"mavi")+" takıma "+(o?"geçti":"atandı"))),o)for(l=n.length-1;0<=l;l--)f.setPlayerTeam(n[l].id,i),n[l].team=i;else{for(l=n.length-1;0<=l;l--)n[l].pref.team=i;r.balance()}},h:"team [player]/all [0/1/2]",a:2},kick:{f:(a,e)=>{var t=g.nameToPlayer(e[0]),e=1<e.length&&0<e[1].length?e.slice(1).join(" "):null;f.kickPlayer(t.id,e,!1)},h:null,a:2},ban:{f:(a,e)=>{var t=g.nameToPlayer(e[0]),e=1<e.length&&0<e[1].length?e.slice(1).join(" "):null;f.kickPlayer(t.id,e,!0)},h:null,a:2},clearbans:{f:()=>{f.clearBans(),g.msgAdmins("ban listesi temizlendi")}},setpw:{f:(a,e)=>{let t=e[0].substring(0,4);t="rand"===t?-1:"null"===t?null:e[0],g.setPW(t,!0)},h:"setpw [pAsS]/rand/null]",a:2},maps:{f:(a,e)=>{e.length&&1<a.admin&&"fetch"===e[0]?(g.fetchMaps(),g.msgAdmins("haritalar tekrar yüklendi")):g.say(Object.keys(u.data.maps).join(", "),a.id)},h:"maps (fetch)",a:1},load:{f:(l,i)=>{if(i.length){let a,e=i[0].toLowerCase(),t=null,n=u.data.maps;for(a in n)if(a.toLowerCase()===e){t=a;break}if(!t)for(a in n)if(a.toLowerCase().includes(e)){t=a;break}t?("object"==typeof n[t]&&(n[t]=JSON.stringify(n[t])),f.stopGame(),f.setCustomStadium(n[t]),f.startGame(),g.msgAdmins(l.name+" "+a+" açtı")):g.say("bu harita yok",l.id)}},h:null,a:1},statsmod:{f:(t,n)=>{if(n.length){let a=n[0].toLowerCase(),e=g;a="on"===a?1:"off"===a?0:parseInt(a),a=isNaN(a)?0:a,e.say(t.name+" istatistikleri "+(a?"açtı":"kapattı")),e=e.stats,e.data[3]=a,e.f.init()}},h:"statsmod on/off",a:2},poplimit:{f:(a,e)=>{let t=parseInt(e[0]);t=isNaN(t)?0:t,u.data.popLimit=t,g.setPW(t&&u.pa.length>=t?-1:null),g.msgAdmins("oyuncu limiti: "+(0===t?"kapalı":t)+" ("+a.name+")")},h:"poplimit [value]",a:2}}};f.onStadiumChange=(a,e)=>{g.stats.data[4]=0},f.onGameStart=a=>{let e=g;clearTimeout(e.t),e=e.stats,e.data[3]&&(e.data[1]=0,e.f.reset())},f.onTeamVictory=a=>{let e=g;e.t=setTimeout(()=>{e.stats.f.victory(a)},3e3)},f.onPlayerTeamChange=(a,e)=>{let t=u.po[a.id];if(e&&t.pref.afk&&0<a.team)return g.say(a.name+" AFK",e.id),f.setPlayerTeam(a.id,0);t.team=a.team},f.onPlayerAdminChange=(e,a)=>{if(a){let a=u.po[e.id];a.admin=e.admin?Math.max(1,a.admin):0}},f.onPlayerJoin=e=>{let a=u.pa,t=e.name.toLowerCase(),n,l=!1;for(n=a.length-1;0<=n;n--)if(a[n].name.toLowerCase()===t)return f.kickPlayer(e.id,"Odada aynı adlı bir oyuncu var.",!1);for(t=u.data,a=t.nameBL,n=a.length-1;0<=n;n--)if(e.name.includes(a[n])){l=!0;break}if(!l)for(a=t.connBL,n=a.length-1;0<=n;n--)if(e.conn===a[n]){l=!0,a.splice(n,1);break}if(l)return f.kickPlayer(e.id,"blacklist",!0);l=Date.now(),t=u.data.recent,n=t.findIndex(a=>a.conn===e.conn),a={id:e.id,name:e.name,team:0,admin:0,pref:{afk:!1,team:0},log:{conn:e.conn,mu:-(l+1e4),lm:l,tc:0,av:null,cc:l,newStats:[0,0,0,0,1,1,0,0,0,0,0],aggScores:[0,0]}},-1===n?(l=null,t=a.log,t.aggStats=[0,0,0,0,0,0,0,0,0,0,0]):(n=t[n],l=n.name,t=a.log,l===e.name&&(l=null),t.av=n.av,n.mu>-t.mu&&(t.mu=n.mu),n.cc>t.cc&&(t.cc=n.cc),t.aggStats=n.aggStats),u.pa.push(a),u.po[a.id]=a,t.av&&f.setPlayerAvatar(a.id,t.av),t=g,t.say("Hoş geldin "+a.name+"!"+(l?" (Önceki ad: "+l+")":"")),t.say("Komutları görmek için .help yazabilirsiniz",a.id),t.balance(),l=u.data.popLimit,l&&u.pa.length>=l&&t.setPW(-1)},f.onPlayerLeave=l=>{if(l=u.po[l.id]){let a=l.log,e={name:l.name,conn:a.conn,av:a.av,mu:a.mu,cc:a.cc,aggStats:a.aggStats},t,n;for(a=u.data.recent,t=a.length-1;0<=t;t--)if(a[t].conn===e.conn){a.splice(t,1);break}for(a.push(e),20<a.length&&a.splice(0,1),n=g,a=u.pa,t=a.length-1;0<=t;t--)if(a[t].id===l.id){a.splice(t,1);break}delete u.po[l.id],n.balance(),e=u.data.popLimit,e&&a.length<e&&n.setPW(null)}},f.onPlayerChat=(e,t)=>{e=u.po[e.id];let n=g,a,l,i,s=Date.now();if(e.admin<1){if(i=e.log,l=i.mu,l<0&&(-l<s?i.mu=0:15<t.length&&(l=-l)),l>s)return n.say(Math.ceil((l-s)/1e3)+" saniye sonra yazı yazabilirsiniz.",e.id),!1;if(a=s-i.lm,5e3<a)i.tc=0;else if(a<1100&&(i.tc++,2<i.tc))return i.tc=0,n.mute(e,1,"spam"),!1;i.lm=s}if("!"===t[0]||"."===t[0]&&"."!==t[1])try{if(a=t.substring(1).split(" "),l=a[0].toLowerCase(),l=n.ch[l],!l)return!1;if(e.admin<1){if((t=e.log).cc>=s)return n.say("lütfen komutları tekrar kullanmak için biraz bekleyin",e.id),!1;t.cc=s+1e3*(l.c||5)}return l.a>e.admin?(n.say("bu komutu kullanmak için admin level "+l.a+" olmalısınız",e.id),!1):!!l.f(e,a.slice(1))}catch(a){return 0<e.admin&&(n.msgAdmins(e.name+", bir sorun oldu. mesaj: "+t),n.msgAdmins(a.message+" @"+a.lineNumber)),!1}},g.stats.f.init(),g.fetchMaps()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);