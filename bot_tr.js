let room=HBInit({roomName:"ðŸ‘½ Haxball OdasÄ±",maxPlayers:10,public:!0,noPlayer:!0});
let Bot={config:{adminPass:"admPs",mapsUrl:"",chatColor:0x81e904,v:"v5.3.0.b"},game:{autoBal:1,popLimit:0,log:{recent:[],nameBL:[],connBL:[]},msg:"X = FREN",maps:[]},pa:[],po:{}}
room.setTeamColors(1,60,0xFFFFFF,[0xB30000,0x6E0000,0x3B0000]);
room.setTeamColors(2,60,0xFFFFFF,[0x107896,0x0C5970,0x094152]);
room.setTeamsLock(!0),room.setScoreLimit(3),room.setTimeLimit(3),room.setDefaultStadium("Big"),room.startGame();
let Lib={t:null,Util:{validate:a=>{let b,c=a.name.toLowerCase(),d=Bot.pa;for(b=d.length-1;0<=b;b--)if(d[b].name.toLowerCase()===c)return room.kickPlayer(a.id,"Odada aynÄ± adlÄ± bir oyuncu var.",!1),!1;for(c=Bot.game.log,d=c.nameBL,b=d.length-1;0<=b;b--)if(a.name.includes(d[b]))return room.kickPlayer(a.id,"blacklist",!0),!1;for(d=c.connBL,b=d.length-1;0<=b;b--)if(a.conn===d[b])return room.kickPlayer(a.id,"blacklist",!0),d.splice(b,1),!1;return!0},adjustPop:()=>{let a=Bot.game.popLimit;Lib.Util.setPW(0===a||room.getPlayerList().length<a?null:"random",!1)},fetchMaps:()=>{if(Bot.config.mapsUrl.length<1){return}let a=Bot.game;fetch(Bot.config.mapsUrl).then(function(a){return a.ok?a.json():Promise.reject({status:a.status,statusText:a.statusText})}).then(function(b){a.maps=b}).catch(a=>{console.log(a)})},mute:(a,b,c=null,d=!0)=>{b=Math.min(10,b),a.log.mu=Date.now()+6e4*b,d&&Lib.say("ðŸ”• "+a.name+" "+(0<b?b+" dakika susturuldu":"artÄ±k konuÅŸabilir"+(c?" ("+c+")":"")))},setPW:(a,b=!0)=>{let c="null"===a||!a||1>a.length?null:"random"===a?Math.round(1e9*Math.random()).toString(16):a;room.setPassword(c),b&&Lib.msgAdmins("ÅŸifre"+(null===c?" temizlendi":": "+c))},mix:a=>{let b,c,d=Bot.pa;for(b=d.length-1;0<=b;b--)c=d[b],room.setPlayerTeam(c.id,0),c.team=0;Lib.balanceTeams(),a&&a()}},say:(a,b)=>{room.sendAnnouncement(a,b,Bot.config.chatColor)},msgAdmins:a=>{let b,c,d=Bot.pa;for(b=d.length-1;0<=b;b--)c=d[b],c.admin&&room.sendAnnouncement(a,c.id)},nameToPlayer:(a=null)=>{if(null===a||1>a.length)return null;let b=Bot.pa;if("#"===a[0])return b.find(b=>b.id===parseInt(a.substring(1)));a=a.toLowerCase();let c,d,e;for(c=b.length-1;0<=c;c--)if(d=b[c],e=d.name.toLowerCase(),e===a)return d;for(c=b.length-1;0<=c;c--)if(d=b[c],e=d.name.toLowerCase(),e.includes(a))return d;return null},balanceTeams:()=>{let b,c,d,e,f=[[],[],[],[]],g=[0,0],h=Bot.pa;for(b=h.length-1;0<=b;b--)if(c=h[b],d=c.pref,!d.afk){if(0<d.team){g[d.team-1]++,f[3].push(c);continue}e=c.team,f[e].push(c),0<e&&g[e-1]++}for(h=f[0],b=h.length-1;0<=b;b--)c=h[b],d=g[0]-g[1],e=0>d?1:0<d?2:1+Math.floor(2*Math.random()),f[e].push(c),g[e-1]++;if(d=g[0]-g[1],1<d||-1>d)for(c=0>d?2:1,h=f[c],d=Math.floor(Math.abs(d)/2),b=h.length-1;0<=b&&(e=Math.floor(Math.random()*h.length),f[3-c].push(h[e]),h.splice(e,1),d--,0!==d);b--);for(b=1;3>b;b++)for(c=f[b],j=c.length-1;0<=j;j--)room.setPlayerTeam(c[j].id,b);for(c=f[3],j=c.length-1;0<=j;j--)room.setPlayerTeam(c[j].id,c[j].pref.team)},join:b=>{let a=Date.now(),c={},e=Bot.game,d=e.log.recent,f=d.findIndex(c=>c.conn===b.conn);if(c.id=b.id,c.name=b.name,c.conn=b.conn,c.team=0,c.admin=!1,c.pref={},c.pref.afk=!1,c.pref.team=0,c.log={},c.log.mu=-(a+1e4),c.log.lm=a,c.log.tc=0,c.log.av=null,-1===f)a=null;else{let b=d[f].log;c.log.av=b.av,b.mu>-c.log.mu&&(c.log.mu=b.mu),a=d[f].name,a===c.name&&(a=null)}Bot.pa.push(c),Bot.po[b.id]=c,room.setPlayerAvatar(c.id,c.log.av),f=Lib,f.say("HoÅŸ geldin "+c.name+"!"+(a?" (Ã–nceki ad: "+a+")":"")),0<e.autoBal&&f.balanceTeams()},leave:b=>{let a=b.log,c={},e=Bot.game;c.name=b.name,c.conn=b.conn,c.log={},c.log.avatar=a.avatar,c.log.mu=a.mu,a=e.log.recent.filter(c=>c.conn!==b.conn),a.push(c),20<a.length&&a.splice(0,1),e.log.recent=a,Bot.po[b.id]=null,Bot.pa=Bot.pa.filter(c=>c.id!==b.id),0<e.autoBal&&Lib.balanceTeams()},checkSpam:(a,b)=>{let c,d=a.log,e=Date.now(),f=d.mu;if(0>f&&(-f<e?d.mu=0:15<b.length&&(f=-f)),f>e)return room.sendAnnouncement(Math.ceil((f-e)/1e3)+" saniye sonra yazÄ± yazabilirsiniz.",a.id),!1;if(c=e-d.lm,5e3<c)d.t=0;else if(1100>c&&(d.tc++,2<d.tc))return d.tc=0,Lib.Util.mute(a,1,"spam"),!1;return d.lm=e,!0},ch:{help:{f:(b,c)=>{let a=Lib.ch;if(!c.length)Lib.say("komutlar: "+Object.keys(a).join(", "),b.id),Lib.say("detaylÄ± bilgi: .help [cmd]",b.id);else if(c[0]in a){let d=a[c[0]];"h"in d&&Lib.say(d.h,b.id)}}},admin:{f:(b,c)=>{c[0]!==Bot.config.adminPass||(b.admin=!0,1<c.length?(room.setPlayerAdmin(b.id,!1),Lib.msgAdmins(b.name+" gizli admin.")):room.setPlayerAdmin(b.id,!0))},h:"admin [password] ([secret])"},say:{f:(b,c)=>{Lib.say(c.join(" "))}},v:{f:a=>{Lib.say(Bot.config.v,a.id)}},m:{f:(b,c)=>{let a=Bot.game;c.length&&(a.msg=c.join(" ")),Lib.say(a.msg)}},pm:{f:(b,c)=>{let a=c.slice(1).join(" "),d=Lib.nameToPlayer(c[0]);Lib.say("(PM) "+b.name+": "+a,d.id),Lib.say("(PM to "+d.name+"): "+a,b.id)},h:"pm [player] [message]"},mute:{f:(b,d)=>{let a,e=d[0].toLowerCase(),c=parseFloat(d[1]),f=Lib.Util.mute;if((isNaN(c)||0>c)&&(c=0),"all"===e){let b,d=Bot.pa;for(b=d.length-1;0<=b;b--)a=d[b],a.a||f(a,c,null,!1);Lib.say("ðŸ”• herkes "+(0<c?c+" dakika susturuldu":"konuÅŸabilir"))}else a=Lib.nameToPlayer(e),a.a||f(a,c,"admin")},h:"mute [player/all] [mins]"},team:{f:(b,c)=>{let a,d,e,f=c[0],g=c[1][0],h=Lib,k=!1;if("-"===g&&(k=!0,c[1]=c[1].substring(1),g=c[1][0]),d="r"===g?1:"b"===g?2:"n"===g?3:parseInt(c[1]),(isNaN(d)||0>d||2<d)&&(d=0),"all"===f)g=Bot.pa,e="Herkes";else if(g=h.nameToPlayer(f),g)e=g.name,g=[g];else return;if(h.say(e+" "+(0===d?"takÄ±m tercihini sildi":(1===d?"kÄ±rmÄ±zÄ±":"mavi")+" takÄ±ma "+(k?"geÃ§ti":"atandÄ±"))),k){for(a=g.length-1;0<=a;a--)g[a].pref.team=d;for(h.balanceTeams(),a=g.length-1;0<=a;a--)g[a].pref.team=0}else{for(a=g.length-1;0<=a;a--)g[a].pref.team=d;h.balanceTeams()}},h:"team [player/all] [0/1/2]"},afk:{f:(b,c)=>{let a=Lib,d=0===c.length?b:a.nameToPlayer(c[0]);d&&(b=d.pref,b.afk=!b.afk,a.say(d.name+" AFK"+(b.afk?"":" deÄŸil")+"."),b.team=0,b.afk&&room.setPlayerTeam(d.id,0),a.balanceTeams())}},recent:{f:a=>{let b,c,d=Bot.game.log.recent,e=d.length;for(Lib.say("recent players (oldest first):"),b=0;b<e;b++)c=d[b],Lib.say("\""+c.name+"\": "+c.conn,a.id)}},blacklist:{f:(b,c)=>{let a,d=c[0],e=c[1],f=Bot.game.log;switch(d){case"ip":d=f.connBL,-1===d.indexOf(e)&&d.push(e);let b=f.recent.find(a=>a.conn===e);a=(b?b.name:e)+" ip-blacklistlendi";break;case"name":f=f.nameBL,-1===f.indexOf(e)&&f.push(e),a=e+" name-blacklistlendi";break;case"clear":f.nameBL=[],f.connBL=[],a="blacklistler temizlendi";break;case"get":Lib.msgAdmins("Names: "+f.nameBL.join(", ")),a="IPs:"+f.connBL.join(", ");break;default:a="pls "+Lib.ch.blacklist.h;}Lib.msgAdmins(a)},h:"blacklist [ip/name/clear/get] ([conn/ExactName])"},clearbans:{f:()=>{room.clearBans(),Lib.msgAdmins("banlar temizlendi")}},kick:{f:(b,c)=>{let a=Lib.nameToPlayer(c[0]),d=1<c.length&&0<c[1].length?c.slice(1).join(" "):null;room.kickPlayer(a.id,d,!1)}},ban:{f:(b,c)=>{let a=Lib.nameToPlayer(c[0]),d=1<c.length&&0<c[1].length?c.slice(1).join(" "):null;room.kickPlayer(a.id,d,!0)}},game:{f:(b,c)=>{let a=c[0],d=Lib.Util.mix,e=b.name+" ";switch(c[0]){case"mix":d(),e+="takÄ±mlarÄ± kardÄ±";break;case"remix":room.stopGame(),d(room.startGame),e+="takÄ±mlarÄ± kardÄ±";break;case"restart":room.stopGame(),room.startGame(),e+="resledi";break;case"autobal":d=parseInt(c[1]),Bot.game.autoBal=0<=d&&3>d?d:1,room.onTeamGoal=2===d?()=>{Lib.Util.mix()}:null,e+="oto karmayÄ± "+(2===d?"her gole ayarladÄ±":1===d?"her maÃ§a ayarladÄ±":"kapattÄ±");break;case"poplimit":d=parseInt(c[1]),d=isNaN(d)?0:d,Bot.game.popLimit=d,Lib.Util.adjustPop(),e+="oyuncu limitini "+(0===d?"kaldÄ±rdÄ±":d+" yaptÄ±");break;default:e=null;}e&&Lib.say(e+".")},h:"game [mix/remix/restart/autobal/poplimit] ([0/1/2])"},setpw:{f:(b,c)=>{Lib.Util.setPW(c[0])},h:"setpw [aBc123/random/null]"},avatar:{f:(b,c)=>{let a,d,e=c[0],f=c[1][0],g=c[2];if("all"===e)a=Bot.pa;else if(a=Lib.nameToPlayer(e),a)a=[a];else return;for(e=a.length,g="c"===f?null:"d"===f?"ðŸŽƒ":g,d=e-1;0<=d;d--)room.setPlayerAvatar(a[d].id,g);1===e&&(a[0].log.av=g)},h:"avatar [player/all] [set/clear/default] ([av])"},map:{f:(b,c)=>{let a=c[0],d=Lib;switch(a){case"list":d.say(Object.keys(Bot.game.maps).join(", "),b.id);break;case"load":if(2>c.length)return;let e,f=c[1].toLowerCase(),g=null,h=Bot.game.maps;for(e in h)if(e.toLowerCase()===f){g=e;break}if(!g)for(e in h)if(e.toLowerCase().includes(f)){g=e;break}g?("object"==typeof h[g]&&(h[g]=JSON.stringify(h[g])),room.stopGame(),room.setCustomStadium(h[g]),0===Bot.game.autoBal?room.startGame():d.Util.mix(room.startGame),d.say(b.name+" "+e+" aÃ§tÄ±")):d.say("bu harita yok",b.id);break;case"fetch":1<c.length&&(Bot.config.mapsUrl=c[1]),d.Util.fetchMaps(),d.msgAdmins(b.name+" haritalarÄ± yÃ¼kledi");break;default:}},h:"map [list/load/fetch] ([mapName/jsonUrl])"},funkyball:{f:(b,c)=>{let a=1===parseInt(c[0]);room.onPlayerBallKick=a?()=>{room.setDiscProperties(0,{color:Math.floor(16777215*Math.random())})}:null,Lib.say("funkyball "+(a?"aÃ§Ä±k":"kapalÄ±"))}}}};room.onGameStop=a=>{if(null!==a)return;let b=Lib;b.t=setTimeout(()=>{0<Bot.game.autoBal?b.Util.mix(room.startGame):room.startGame()},1e3)},room.onGameStart=()=>{clearTimeout(Lib.t)},room.onPlayerChat=(d,e)=>{d=Bot.po[d.id];let f=Lib;if(!d.admin&&!f.checkSpam(d,e))return!1;if("."===e[0]&&"."!==e[1])try{let g=e.substring(1).split(" "),c=g[0].toLowerCase(),b=f.ch;return!!("admin"===c||d.admin&&c in b)&&!!b[c].f(d,g.slice(1))}catch(a){room.sendAnnouncement("bir sorun oldu"),d.admin&&f.msgAdmins(a.message+" @"+a.lineNumber),console.log("hata: "+a.message),console.dir(a.stack)}},room.onPlayerTeamChange=a=>{Bot.po[a.id].team=a.team},room.onPlayerAdminChange=(a,c)=>{c&&(Bot.po[a.id].admin=a.admin)},room.onPlayerJoin=a=>{let b=Lib,c=b.Util;c.validate(a)&&b.join(a),Bot.game.popLimit&&c.adjustPop()},room.onPlayerLeave=a=>{let b=Lib;a=Bot.po[a.id],a&&b.leave(a),Bot.game.popLimit&&b.Util.adjustPop()},Lib.Util.fetchMaps();