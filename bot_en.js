!function(e){let r=e.room=HBInit({roomName:"👽 Haxball Room",maxPlayers:12,public:!0,noPlayer:!0}),d=e.Bot={config:{adminPass:"admPs",mapsUrl:""},pa:[],po:{},data:{mode:4,popLimit:0,msg:"",recent:[],nameBL:[],connBL:[],maps:[]},stats:{kc:{id:1,team:1},kl:{id:1,team:1},vs:[0,0],onKick:e=>{let a=d.stats,t=Date.now();t-a.t<250||(a.kl=a.kc,a.kc={id:e.id,team:e.team,x:e.position.x},a.t=t)},onGoal:e=>{let a=d.stats,t="⚽ Gol",n=d.po,l,s;l=a.kc,s=n[l.id],s&&(t+="! "+n[l.id].name+" (",l.team===e?(a=a.kl,t+="mesafe: "+Math.ceil(Math.abs(700*Math.sign(1.5-e)-l.x)/14)+"m",a.team===e&&l.id!==a.id&&(a=n[a.id],a&&(t+=", asist: "+n[a.id].name))):t+="kendi kalesine",t+=")"),c.say(t)}}};r.setTeamColors(1,60,16777215,[11730944,7208960,3866624]),r.setTeamColors(2,60,16777215,[1079446,809328,606546]),r.setTeamsLock(!0),r.setScoreLimit(3),r.setTimeLimit(5),r.setDefaultStadium("Easy"),r.startGame();let c={t:null,victory:e=>{r.stopGame();let a=d.data.mode;if(-1===a)return r.startGame();let t=d.pa,n,l,s,i=d.stats.vs;for(i[e-1]++,i[2-e]=0,c.say("🏆 "+(1===e?"Kırmızı":"Mavi")+" takım kazandı. Tebrikler! Kırmızı "+i[0]+":"+i[1]+" Mavi"),(2<i[0]||2<i[1])&&(a=-2,i[0]=0,i[1]=0),n=t.length-1;0<=n;n--)l=t[n],s=l.pref,s.afk||(-2===a?(s.team=0===l.team?e-3:s.team,l.team=0,r.setPlayerTeam(l.id,0)):0===a||l.team===3-e?(l.team=0,r.setPlayerTeam(l.id,0)):0===l.team&&(s.team=e-3));c.balance(),r.startGame()},balance:()=>{var m=d.data.mode;if(-1!==m){let e=[[],[],[],[],[]],a,t=d.pa,n,l,s,i;for(a=t.length-1;0<=a;a--)n=t[a],l=n.pref,l.afk||(0===l.team?e[n.team].push(n.id):(e[Math.abs(l.team)+2].push(n.id),l.team<0&&(l.team=0)));for(t=e[0],a=t.length-1;0<a;a--)l=Math.floor(Math.random()*(a+1)),n=t[a],t[a]=t[l],t[l]=n;for(a=t.length-1;0<=a&&(s=e[1].length+e[3].length,i=e[2].length+e[4].length,!(0<m&&s>=m&&i>=m));a--)l=s-i,n=0===l?1+Math.floor(2*Math.random()):0<l?2:1,e[n].push(t[a]),t.splice(a,1);if(0===m){if(l=e[1].length+e[3].length-e[2].length-e[4].length,l<-1||1<l)for(i=l<0?2:1,t=e[i],l=Math.floor(Math.abs(l)/2),a=t.length-1;0<=a&&(n=t[a],e[3-i].push(n),t.splice(a,1),l--,0!==l);a--);}else for(a=1;a<3;a++)if(t=e[a],n=t.length+e[a+2].length,n>m)for(n-=m,l=t.length-1;0<=l&&(e[0].push(t[l]),t.splice(l,1),n--,0!==n);l--);for(a=0;a<5;a++)for(n=e[a],l=n.length-1;0<=l;l--)r.setPlayerTeam(n[l],a<3?a:a-2)}},fetchMaps:()=>{if(!(d.config.mapsUrl.length<1)){let a=d.data;fetch(d.config.mapsUrl).then(function(e){return e.ok?e.json():Promise.reject({status:e.status,statusText:e.statusText})}).then(function(e){a.maps=e}).catch(e=>{console.log(e)})}},setPW:(e,a=!1)=>{e=!e||e.length<1?null:-1===e?Math.round(1e9*Math.random()).toString(16):e,r.setPassword(e),a&&c.msgAdmins("password"+(null===e?" cleared":": "+e))},nameToPlayer:(e=null)=>{if(null===e||e.length<1)return null;if("#"===e[0])return d.po[parseInt(e.substring(1))];e=e.toLowerCase();let a=d.pa,t,n,l;for(t=a.length-1;0<=t;t--)if(n=a[t],l=n.name.toLowerCase(),l===e)return n;for(t=a.length-1;0<=t;t--)if(n=a[t],l=n.name.toLowerCase(),l.includes(e))return n;return null},mix:e=>{let a,t,n=d.pa;for(a=n.length-1;0<=a;a--)t=n[a],r.setPlayerTeam(t.id,0),t.team=0;c.balance(),e&&e()},mute:(e,a,t=null,n=!0)=>{e.log.mu=Date.now()+6e4*a,n&&c.say("🔕 "+e.name+" is "+(0<a?"muted for "+a+" minutes"+(t?" ("+t+")":""):"unmuted"))},say:(e,a)=>{r.sendAnnouncement(e,a,a?11393254:8513796)},msgAdmins:(e,a=1)=>{let t,n,l=d.pa;for(t=l.length-1;0<=t;t--)n=l[t],n.admin>=a&&r.sendAnnouncement(e,n.id,16768768)},ch:{help:{f:(e,a)=>{let t=c,n=t.ch,l;a.length?a[0]in n&&(l=n[a[0]],"h"in l&&l.h&&t.say(l.h,e.id)):(t.say("commands: "+Object.keys(n).join(", "),e.id),t.say("detailed help: .help [cmd]",e.id))},h:null,a:1},admin:{f:(e,a)=>{e.admin<=0&&a[0]!==d.config.adminPass||(e.admin=2,1<a.length?(r.setPlayerAdmin(e.id,!1),c.msgAdmins(e.name+" is hidden admin.")):r.setPlayerAdmin(e.id,!0))},h:"admin [password] (hidden)",a:0},setadminlevel:{f:(e,a)=>{let t=c.nameToPlayer(a[0]),n=Math.min(2,Math.abs(parseInt(a[1])));t.admin=n,r.setPlayerAdmin(t.id,0<n&&a.length<3),c.msgAdmins(t.name+" is "+(0===n?" not":"")+(0<n&&2<a.length?"hidden ":"")+"admin ("+e.name+")")},h:"setadminlevel [player] [level] (hidden)",a:2},say:{f:(e,a)=>{c.say(a.join(" "))},h:null,a:1},v:{f:(e,a)=>{c.say("v5.4.1")},h:null,a:1},m:{f:(e,a)=>{let t=d.data;a.length&&(t.msg=a.join(" ")),c.say(t.msg)},h:"m ([msg])",a:1},pm:{f:(e,a)=>{var t=a.slice(1).join(" "),a=c.nameToPlayer(a[0]);c.say("(PM) "+e.name+": "+t,a.id),c.say("(PM to "+a.name+"): "+t,e.id)},h:"pm [player] [message]",a:2},mute:{f:(e,a)=>{let t=a[0].toLowerCase(),n=Math.min(parseFloat(a[1]),10),l,s=c.mute;if((isNaN(n)||n<0)&&(n=0),"all"===t){let e,a=d.pa;for(e=a.length-1;0<=e;e--)l=a[e],l.a||s(l,n,null,!1);c.say("🔕 everyone is "+(0<n?"muted for "+n+" minutes":"unmuted"))}else l=c.nameToPlayer(t),l.a||s(l,n,"admin")},h:"mute [player/all] [mins]",a:2},team:{f:(e,a)=>{let t=a[0],n=a[1][0],l,s,i,m=c,o=!1;if("-"===n&&(o=!0,a[1]=a[1].substring(1),n=a[1][0]),s="r"===n?1:"b"===n?2:"n"===n?0:parseInt(a[1]),(isNaN(s)||s<0||2<s)&&(s=0),"all"===t)n=d.pa,i="Everyone";else{if(n=m.nameToPlayer(t),!n)return;i=n.name,n=[n]}if(m.say(i+" "+(0===s?"removed their team preference":"is "+(o?"moved":"assigned")+" to "+(1===s?"red":"blue")+" team")),o)for(l=n.length-1;0<=l;l--)r.setPlayerTeam(n[l].id,s),n[l].team=s;else{for(l=n.length-1;0<=l;l--)n[l].pref.team=s;m.balance()}},h:"team [player/all] [0/1/2]",a:2},afk:{f:(e,a)=>{let t=c,n=0===a.length?e:t.nameToPlayer(a[0]);n&&((e=n.pref).afk=!e.afk,t.say(n.name+" is"+(e.afk?"":" not")+" AFK."),e.team=0,e.afk&&r.setPlayerTeam(n.id,0),t.balance())},h:null,a:1},blacklist:{f:(e,a)=>{let t=a[0],n=a[1],l=d.data,s;switch(t){case"recent":for(c.say("recent players (oldest first):",e.id),l=l.recent,n=0;n<l.length;n++)t=l[n],c.say('"'+t.name+'": '+t.conn,e.id);s=null;break;case"ip":t=l.connBL,-1===t.indexOf(n)&&t.push(n);var i=l.recent.find(e=>e.conn===n);s=(i?i.name:n)+" ip-blacklisted";break;case"name":l=l.nameBL,-1===l.indexOf(n)&&l.push(n),s=n+" name-blacklisted";break;case"clear":l.nameBL=[],l.connBL=[],s="blacklists cleared";break;case"get":c.msgAdmins("Blacklists:"),c.msgAdmins("Names: "+l.nameBL.join(", ")),s="IPs:"+l.connBL.join(", ");break;default:c.say("pls "+c.ch.blacklist.h,e.id),s=null}s&&c.msgAdmins(s)},h:"blacklist [clear/get/recent/ip/name] ([conn/ExactName])",a:2},kick:{f:(e,a)=>{var t=c.nameToPlayer(a[0]),a=1<a.length&&0<a[1].length?a.slice(1).join(" "):null;r.kickPlayer(t.id,a,!1)},h:null,a:2},ban:{f:(e,a)=>{var t=c.nameToPlayer(a[0]),a=1<a.length&&0<a[1].length?a.slice(1).join(" "):null;r.kickPlayer(t.id,a,!0)},h:null,a:2},game:{f:(e,a)=>{let t=c.mix,n=e.name;switch(a[0]){case"mix":t(),n+=" mixed the teams";break;case"remix":r.stopGame(),t(r.startGame),n+=" mixed the teams";break;case"restart":r.stopGame(),r.startGame(),n+=" restarted the game";break;case"mode":t=a[1][0].toLowerCase(),t="m"===t?-1:"f"===t?0:parseInt(a[1]),t=isNaN(t)?0:t<0?-1:t,d.data.mode=t,c.balance(),n+=", game mode: "+(-1===t?"manual":0===t?"free for all":t+"v"+t);break;case"poplimit":t=parseInt(a[1]),t=isNaN(t)?0:Math.abs(t),d.data.popLimit=t,c.setPW(t&&d.pa.length>=t?-1:null),n+=" set pop limit "+(0===t?"off":t);break;case"commentator":t=a[1].toLowerCase(),t="on"===t?1:"off"===t?0:parseInt(t),t=isNaN(t)?0:t,n+=" set commentator "+(1===t?"on":"off"),0===t?(r.onPlayerBallKick=null,r.onTeamGoal=null):(t=d.stats,r.onPlayerBallKick=t.onKick,r.onTeamGoal=t.onGoal);break;default:n=null}n&&c.msgAdmins(n)},h:"game mix/remix/restart/mode/commentator/poplimit ([value])",a:2},setpw:{f:(e,a)=>{let t=a[0].substring(0,4);t="rand"===t?-1:"null"===t?null:a[0],c.setPW(t,!0)},h:"setpw [aBc123/rand/null]",a:2},avatar:{f:(e,a)=>{let t=a[0],n=a[1][0],l,s,i;if("all"===t)s=d.pa;else{if(s=c.nameToPlayer(t),!s)return;s=[s]}for(t=s.length,l="c"===n?null:"d"===n?"🎃":a[1],i=t-1;0<=i;i--)r.setPlayerAvatar(s[i].id,l);1===t&&(s[0].log.av=l)},h:"avatar [player/all] clear/default/[av]",a:2},maps:{f:(e,a)=>{a.length&&"fetch"===a[0]?(c.fetchMaps(),c.msgAdmins("stadiums reloaded")):c.say(Object.keys(d.data.maps).join(", "),e.id)},h:"maps (fetch)",a:2},load:{f:(l,s)=>{if(s.length){let e,a=s[0].toLowerCase(),t=null,n=d.data.maps;for(e in n)if(e.toLowerCase()===a){t=e;break}if(!t)for(e in n)if(e.toLowerCase().includes(a)){t=e;break}t?("object"==typeof n[t]&&(n[t]=JSON.stringify(n[t])),r.stopGame(),r.setCustomStadium(n[t]),r.startGame(),c.msgAdmins(l.name+" loaded "+e)):c.say("no such stadium",l.id)}},h:null,a:2}}};r.onPlayerTeamChange=e=>{d.po[e.id].team=e.team},r.onPlayerAdminChange=(a,e)=>{if(e){let e=d.po[a.id];e.admin=a.admin?Math.max(1,e.admin):0}},r.onGameStart=e=>{clearTimeout(c.t)},r.onTeamVictory=e=>{let a=c;a.t=setTimeout(()=>{a.victory(e.red>e.blue?1:2)},5e3)},r.onPlayerJoin=a=>{let e=d.pa,t=a.name.toLowerCase(),n,l=!1;for(n=e.length-1;0<=n;n--)if(e[n].name.toLowerCase()===t)return r.kickPlayer(a.id,"Name is already taken.",!1);for(t=d.data,e=t.nameBL,n=e.length-1;0<=n;n--)if(a.name.includes(e[n])){l=!0;break}if(!l)for(e=t.connBL,n=e.length-1;0<=n;n--)if(a.conn===e[n]){l=!0,e.splice(n,1);break}if(l)return r.kickPlayer(a.id,"blacklist",!0);let s={},i={};l=Date.now(),t=d.data.recent,n=t.findIndex(e=>e.conn===a.conn),s.id=a.id,s.name=a.name,s.team=0,s.admin=0,i.afk=!1,i.team=0,s.pref=i,i={},i.conn=a.conn,i.mu=-(l+1e4),i.lm=l,i.tc=0,i.av=null,s.log=i,-1===n?l=null:(n=t[n],l=n.name,l===s.name&&(l=null),i.av=n.av,n.mu>-i.mu&&(i.mu=n.mu)),d.pa.push(s),d.po[s.id]=s,i.av&&r.setPlayerAvatar(s.id,i.av),i=c,i.say("Welcome "+s.name+"!"+(l?" (Previous name: "+l+")":"")),i.balance(),s=d.data.popLimit,s&&d.pa.length>=s&&i.setPW(-1)},r.onPlayerLeave=l=>{if(l=d.po[l.id]){let e={},a=l.log,t={},n;for(e.name=l.name,e.conn=a.conn,e.av=a.av,e.mu=a.mu,a=d.data.recent,n=a.length-1;0<=n;n--)if(a[n].conn===e.conn){a.splice(n,1);break}for(a.push(e),20<a.length&&a.splice(0,1),t=c,d.po[l.id]=null,a=d.pa,n=a.length-1;0<=n;n--)if(a[n].id===l.id){a.splice(n,1);break}t.balance(),e=d.data.popLimit,e&&a.length<e&&t.setPW(null)}},r.onPlayerChat=(e,a)=>{e=d.po[e.id];let t=c,n,l,s;if(e.admin<1){var i=Date.now();if(s=e.log,l=s.mu,l<0&&(-l<i?s.mu=0:15<a.length&&(l=-l)),l>i)return r.sendAnnouncement("you can chat in "+Math.ceil((l-i)/1e3)+" seconds.",e.id),!1;if(n=i-s.lm,5e3<n)s.t=0;else if(n<1100&&(s.tc++,2<s.tc))return s.tc=0,t.mute(e,1,"spam"),!1;s.lm=i}if("."===a[0]&&"."!==a[1])try{return n=a.substring(1).split(" "),l=n[0].toLowerCase(),l=t.ch[l],l.a>e.admin?(t.say("you are not authorized to use this command",e.id),!1):!!l.f(e,n.slice(1))}catch(n){return 0<e.admin&&(t.msgAdmins(e.name+", an error occurred. message: "+a),t.msgAdmins(n.message+" @"+n.lineNumber)),!1}},c.fetchMaps()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);